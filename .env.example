# TechScan Environment Variables
# Copy this file to .env and configure as needed
# Documentation: See implementation_plan.md for detailed descriptions

# ============================================
# DATABASE
# ============================================
# Set to 1 to disable database entirely (in-memory mode)
TECHSCAN_DISABLE_DB=0

# Option 1: Full database URL (overrides individual settings below)
# TECHSCAN_DB_URL=postgresql://user:password@host:port/dbname

# Option 2: Individual database settings
TECHSCAN_DB_HOST=127.0.0.1
TECHSCAN_DB_PORT=5432
TECHSCAN_DB_NAME=techscan
TECHSCAN_DB_USER=postgres
TECHSCAN_DB_PASSWORD=your_password_here

# Allow empty password (development only, set to 1)
# TECHSCAN_ALLOW_EMPTY_DB_PASSWORD=0

# Connection pool settings
TECHSCAN_DB_POOL_SIZE=10
# TECHSCAN_DB_POOL_MONITOR=0
# TECHSCAN_DB_POOL_MONITOR_INTERVAL=10

# ============================================
# LOGGING
# ============================================
TECHSCAN_LOG_LEVEL=INFO
# TECHSCAN_LOG_FILE=/path/to/techscan.log
# TECHSCAN_LOG_MAX_BYTES=5242880
# TECHSCAN_LOG_BACKUP_COUNT=5

# ============================================
# WAPPALYZER / NODE SCANNER
# ============================================
# Path to Wappalyzer installation (REQUIRED)
WAPPALYZER_PATH=d:\wappalyzer\wappalyzer3\wappalyzer-master

# Node.js settings
# TECHSCAN_NODE=node
TECHSCAN_NODE_CONCURRENCY=3
# TECHSCAN_NODE_MAX_OLD_SPACE=4096
# TECHSCAN_NPM_CMD=npm

# ============================================
# PERSISTENT BROWSER MODE
# ============================================
# Enable persistent browser for better detection (recommended)
TECHSCAN_PERSIST_BROWSER=1
TECHSCAN_PERSIST_TIMEOUT=70

# Watchdog settings (auto-restart on failures)
# TECHSCAN_PERSIST_WATCHDOG=0
# TECHSCAN_PERSIST_FAIL_THRESHOLD=5
# TECHSCAN_PERSIST_RESTART_WINDOW=180
# TECHSCAN_PERSIST_START_ATTEMPTS=2
# TECHSCAN_PERSIST_START_BACKOFF=0.4
# TECHSCAN_DISABLE_PERSIST_AUTOSTART=0

# ============================================
# SCAN MODES
# ============================================
TECHSCAN_UNIFIED=1
TECHSCAN_FORCE_FULL=1
# TECHSCAN_TIERED=0
# TECHSCAN_TIERED_ALLOW_EMPTY=0
TECHSCAN_VERSION_AUDIT=1
# TECHSCAN_ULTRA_QUICK=0
# TECHSCAN_ULTRA_FALLBACK_MICRO=0
# TECHSCAN_DISABLE_ADAPTIVE=0

# Timeouts and budgets
# TECHSCAN_QUICK_BUDGET_MS=700
# TECHSCAN_MICRO_TIMEOUT_S=2

# ============================================
# WEEKLY RESCAN (Background Job)
# ============================================
# Enable/disable weekly rescan (1=enabled)
TECHSCAN_WEEKLY_RESCAN=1

# Cron schedule (default: Sunday 3AM)
TECHSCAN_WEEKLY_RESCAN_CRON=0 3 * * 0

# Configuration limits
TECHSCAN_WEEKLY_RESCAN_MAX=2000
# TECHSCAN_WEEKLY_RESCAN_LOOKBACK_DAYS=7
TECHSCAN_WEEKLY_RESCAN_CONCURRENCY=3
# TECHSCAN_WEEKLY_RESCAN_BUDGET_MS=15000
# TECHSCAN_WEEKLY_RESCAN_INTERVAL_S=604800

# ============================================
# RATE LIMITING & REDIS
# ============================================
TECHSCAN_RATE_LIMIT=60 per minute

# Redis URL for rate limiter storage (optional, uses memory if not set)
# TECHSCAN_REDIS_URL=redis://localhost:6379/0

# ============================================
# BULK OPERATIONS
# ============================================
# TECHSCAN_BULK_BATCH_TTL=1800
# TECHSCAN_BULK_BATCH_MAX=50

# ============================================
# NETWORK / DNS
# ============================================
TECHSCAN_PREFLIGHT=1
TECHSCAN_DNS_NEG_CACHE=600

# ============================================
# UI SETTINGS
# ============================================
# Template auto-reload (development only)
# TECHSCAN_TEMPLATE_AUTO_RELOAD=0

# Stats page auto-refresh (default: off/manual)
# Set to 1 to enable auto-refresh on stats page
# TECHSCAN_STATS_AUTO_REFRESH=0
# TECHSCAN_STATS_AUTO_REFRESH_INTERVAL_MS=300000

# ============================================
# ADMIN / SECURITY
# ============================================
# Admin API authentication token (REQUIRED for production!)
# If not set and TECHSCAN_ADMIN_OPEN=0, admin endpoints will be blocked
# TECHSCAN_ADMIN_TOKEN=your_secret_token_here

# Allow admin access without token (development only, NOT for production!)
# Set to 1 only for local development
TECHSCAN_ADMIN_OPEN=0

# Custom Content-Security-Policy header (optional)
# TECHSCAN_CSP=default-src 'self'; script-src 'self' 'unsafe-inline';

# Node fallback threshold (trigger additional detection if tech count <= this)
TECHSCAN_UNIFIED_MIN_TECH=25

# ============================================
# DATABASE CLEANUP (Scheduled)
# ============================================
# Enable automatic cleanup of old scan records (default: disabled)
TECHSCAN_CLEANUP_ENABLED=0

# Retention period in days (records older than this will be deleted)
TECHSCAN_CLEANUP_DAYS=90

# How often to run cleanup (in hours)
TECHSCAN_CLEANUP_INTERVAL_HOURS=24

# ============================================
# MISCELLANEOUS
# ============================================
TECHSCAN_VERSION=0.3.0
# TECHSCAN_DOMAIN_GROUPS_FILE=./data/domain_groups.json
# TECHSCAN_HEURISTIC_HTML_CAP_BYTES=0
# TECHSCAN_LATEST_VERSIONS_FILE=./data/latest_versions.json

# ============================================
# TIMEOUT SETTINGS
# ============================================
# Deep full scan timeout in seconds
TECHSCAN_DEEP_FULL_TIMEOUT_S=15

# Fast full timeout in milliseconds
TECHSCAN_FAST_FULL_TIMEOUT_MS=10000

# Enable ultra fallback micro detection
TECHSCAN_ULTRA_FALLBACK_MICRO=1
